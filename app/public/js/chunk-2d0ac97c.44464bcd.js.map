{"version":3,"sources":["webpack:///./src/components/Goods/List.vue","webpack:///./src/components/Goods/List.vue?b4ba"],"names":["class","spinning","type","sort","changeSort","style","edit","activeKey","status","changeStatus","key","tab","modal","formData","layout","label","value","name","placeHolder","getGoodsList","columns","data-source","goodsList","pagination","tablePagination","rowKey","row","id","pic","text","src","fallback","preview","alt","width","height","record","sort_order","min","changeGoodsStatus","isIndex","checked","is_index","isOnSale","is_on_sale","operation","expandedRowRender","innerColumns","product","size","data","title","dataIndex","slots","customRender","defaultPageSize","hideOnSinglePage","showQuickJumper","showTotal","total","onChange","page","methods","$axios","method","$api","GET_GOODS_LIST","url","params","response","list","count","console","log","$modal","confirm","okText","okType","cancelText","maskClosable","content","onOk","DELETE_GOODS","$message","success","$router","push","this","update","CHANGE_GOODS_STATUS","mounted","render"],"mappings":"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","file":"js/chunk-2d0ac97c.44464bcd.js","sourcesContent":["<template>\r\n  <a-spin :spinning=\"spinning\">\r\n    <div class=\"content-box goods-list\">\r\n      <div class=\"btn-group\">\r\n        <a-button :type=\"sort === 'default'? 'primary':'default'\" @click=\"changeSort('default')\" style=\"margin-right: 10px\">默认排序</a-button>\r\n        <a-button :type=\"sort === 'sale'? 'primary':'default'\" @click=\"changeSort('sale')\" style=\"margin-right: 10px\">按销量排序</a-button>\r\n        <a-button :type=\"sort === 'price'? 'primary':'default'\" @click=\"changeSort('price')\" style=\"margin-right: 10px\">按售价排序</a-button>\r\n        <a-button :type=\"sort === 'stock'? 'primary':'default'\" @click=\"changeSort('stock')\">按库存排序</a-button>\r\n        <a-button style=\"float: right\" type=\"primary\" @click=\"edit('add')\">添加商品</a-button>\r\n      </div>\r\n      <a-tabs v-model:activeKey=\"status\" @change=\"changeStatus\" style=\"margin-top: 20px\">\r\n        <a-tab-pane key=\"1\" tab=\"全部商品\" />\r\n        <a-tab-pane key=\"2\" tab=\"出售中\" />\r\n        <a-tab-pane key=\"3\" tab=\"已售完\" />\r\n        <a-tab-pane key=\"4\" tab=\"已下架\" />\r\n      </a-tabs>\r\n      <a-form :modal=\"formData\" layout=\"inline\">\r\n        <a-form-item label=\"商品名称\">\r\n          <a-input v-model:value=\"formData.name\" placeHolder=\"请输入商品名称\"></a-input>\r\n        </a-form-item>\r\n        <a-form-item>\r\n          <a-button type=\"primary\" @click=\"getGoodsList(sort, status, 1, formData.name)\">查询</a-button>\r\n        </a-form-item>\r\n        <a-form-item>\r\n          <a-button @click=\"formData.name = ''; getGoodsList(sort, status, 1, formData.name);\">清空</a-button>\r\n        </a-form-item>\r\n      </a-form>\r\n      <a-table\r\n        :columns=\"columns\"\r\n        :data-source=\"goodsList\"\r\n        :pagination=\"tablePagination\"\r\n        :rowKey=\"(row) => row.id\"\r\n        style=\"margin-top: 10px\"\r\n        >\r\n        <template #pic=\"{text}\">\r\n          <a-image\r\n            :src=\"text\"\r\n            fallback=\"/images/fallback.png\"\r\n            :preview=\"false\"\r\n            alt=\"商品图片\"\r\n            :width=\"60\"\r\n            :height=\"60\"\r\n          ></a-image>\r\n        </template>\r\n        <template #sort=\"{record}\">\r\n          <a-input-number v-model:value=\"record.sort_order\" :min=\"1\" @change=\"changeGoodsStatus('sort', record)\"></a-input-number>\r\n        </template>\r\n        <template #isIndex=\"{record}\">\r\n          <a-switch v-model:checked=\"record.is_index\" @change=\"changeGoodsStatus('index', record)\"></a-switch>\r\n        </template>\r\n        <template #isOnSale=\"{record}\">\r\n          <a-switch v-model:checked=\"record.is_on_sale\" @change=\"changeGoodsStatus('sale', record)\"></a-switch>\r\n        </template>\r\n        <template #operation=\"{record}\">\r\n          <a-button type=\"primary\" style=\"margin-right: 10px\" @click=\"edit('edit', record)\">编辑</a-button>\r\n          <a-button type=\"danger\" @click=\"edit('delete',record)\">删除</a-button>\r\n        </template>\r\n        <template #expandedRowRender=\"{record}\">\r\n          <a-table :columns=\"innerColumns\" :data-source=\"record.product\" :pagination=\"false\" size=\"small\" />\r\n        </template>\r\n      </a-table>\r\n    </div>\r\n  </a-spin>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'GoodsList',\r\n  data () {\r\n    return {\r\n      spinning: false,\r\n      sort: 'default', // sale销量 price售价 stock库存\r\n      status: '2',\r\n      formData: {\r\n        name: ''\r\n      },\r\n      columns: [\r\n        {\r\n          title: 'ID',\r\n          dataIndex: 'id',\r\n          key: 'id'\r\n        },\r\n        {\r\n          title: '商品图片',\r\n          dataIndex: 'list_pic_url',\r\n          key: 'list_pic_url',\r\n          slots: {\r\n            customRender: 'pic'\r\n          }\r\n        },\r\n        {\r\n          title: '商品名称',\r\n          dataIndex: 'name',\r\n          key: 'name'\r\n        },\r\n        {\r\n          title: '分类',\r\n          dataIndex: 'category_name',\r\n          key: 'category_name'\r\n        },\r\n        {\r\n          title: '排序',\r\n          dataIndex: 'sort_order',\r\n          key: 'sort_order',\r\n          slots: {\r\n            customRender: 'sort'\r\n          }\r\n        },\r\n        {\r\n          title: '销量',\r\n          dataIndex: 'sell_volume',\r\n          key: 'sell_volume'\r\n        },\r\n        {\r\n          title: '库存',\r\n          dataIndex: 'goods_number',\r\n          key: 'goods_number'\r\n        },\r\n        {\r\n          title: '首页显示',\r\n          dataIndex: 'is_index',\r\n          key: 'is_index',\r\n          slots: {\r\n            customRender: 'isIndex'\r\n          }\r\n        },\r\n        {\r\n          title: '上架',\r\n          dataIndex: 'is_on_sale',\r\n          key: 'is_on_sale',\r\n          slots: {\r\n            customRender: 'isOnSale'\r\n          }\r\n        },\r\n        {\r\n          title: '操作',\r\n          key: 'operation',\r\n          slots: {\r\n            customRender: 'operation'\r\n          }\r\n        }\r\n      ],\r\n      innerColumns: [\r\n        {\r\n          title: 'ID',\r\n          dataIndex: 'id',\r\n          key: 'id'\r\n        },\r\n        {\r\n          title: '商品SKU',\r\n          dataIndex: 'goods_sn',\r\n          key: 'goods_sn'\r\n        },\r\n        {\r\n          title: '快递单上的简称',\r\n          dataIndex: 'goods_name',\r\n          key: 'goods_name'\r\n        },\r\n        {\r\n          title: '型号/规格',\r\n          dataIndex: 'value',\r\n          key: 'value'\r\n        },\r\n        {\r\n          title: '成本(元)',\r\n          dataIndex: 'cost',\r\n          key: 'cost'\r\n        },\r\n        {\r\n          title: '零售(元)',\r\n          dataIndex: 'retail_price',\r\n          key: 'retail_price'\r\n        },\r\n        {\r\n          title: '重量(KG)',\r\n          dataIndex: 'goods_weight',\r\n          key: 'goods_weight'\r\n        },\r\n        {\r\n          title: '库存',\r\n          dataIndex: 'goods_number',\r\n          key: 'goods_number'\r\n        }\r\n      ],\r\n      tablePagination: {\r\n        defaultPageSize: 20,\r\n        hideOnSinglePage: true,\r\n        showQuickJumper: true,\r\n        showTotal: (total) => `共 ${total} 条`,\r\n        total: 0,\r\n        onChange: (page) => {\r\n          this.getGoodsList(this.sort, this.status, page, this.formData.name)\r\n          this.page = page\r\n        }\r\n      },\r\n      page: 1,\r\n      goodsList: []\r\n    }\r\n  },\r\n  methods: {\r\n    async getGoodsList (sort, status, page, name) {\r\n      this.spinning = true\r\n      try {\r\n        const response = await this.$axios({\r\n          method: this.$api.GET_GOODS_LIST.method,\r\n          url: this.$api.GET_GOODS_LIST.url,\r\n          params: {\r\n            sort,\r\n            status,\r\n            page,\r\n            name\r\n          }\r\n        })\r\n        this.goodsList = response.data.list\r\n        this.tablePagination.total = response.data.count\r\n        this.spinning = false\r\n      } catch (err) {\r\n        console.log('获取商品列表失败。[getGoodsList]', err)\r\n        this.spinning = false\r\n      }\r\n    },\r\n    async edit (type, data = null) {\r\n      if (type === 'delete') {\r\n        this.$modal.confirm({\r\n          okText: '确定',\r\n          okType: 'danger',\r\n          cancelText: '取消',\r\n          maskClosable: true,\r\n          content: '确定删除此商品?',\r\n          onOk: async () => {\r\n            this.spinning = true\r\n            try {\r\n              await this.$axios({\r\n                method: this.$api.DELETE_GOODS.method,\r\n                url: this.$api.DELETE_GOODS.url,\r\n                params: {\r\n                  id: data.id\r\n                }\r\n              })\r\n              this.$message.success('删除成功')\r\n              this.spinning = false\r\n              this.getGoodsList(this.sort, this.status, 1, this.formData.name)\r\n            } catch (err) {\r\n              console.log('删除商品失败。[edit]', err)\r\n              this.spinning = false\r\n            }\r\n          }\r\n        })\r\n      } else {\r\n        let id = ''\r\n        if (type === 'edit') {\r\n          id = data.id\r\n        }\r\n        this.$router.push('/goods/edit?id=' + id)\r\n      }\r\n    },\r\n    changeSort (sort) {\r\n      this.sort = sort\r\n      this.getGoodsList(this.sort, this.status, 1, this.formData.name)\r\n    },\r\n    changeStatus (key) {\r\n      this.getGoodsList(this.sort, key, 1, this.formData.name)\r\n    },\r\n    async changeGoodsStatus (type, data) {\r\n      let update = null\r\n      if (type === 'sort') {\r\n        update = {\r\n          type,\r\n          id: data.id,\r\n          sort_order: data.sort_order\r\n        }\r\n      } else if (type === 'index') {\r\n        update = {\r\n          type,\r\n          id: data.id,\r\n          is_index: data.is_index\r\n        }\r\n      } else if (type === 'sale') {\r\n        update = {\r\n          type,\r\n          id: data.id,\r\n          is_on_sale: data.is_on_sale\r\n        }\r\n      }\r\n      try {\r\n        await this.$axios({\r\n          method: this.$api.CHANGE_GOODS_STATUS.method,\r\n          url: this.$api.CHANGE_GOODS_STATUS.url,\r\n          data: update\r\n        })\r\n        this.getGoodsList(this.sort, this.status, this.page, this.formData.name)\r\n      } catch (err) {\r\n        console.log(err)\r\n        this.spinning = false\r\n        this.getGoodsList(this.sort, this.status, this.page, this.formData.name)\r\n      }\r\n    }\r\n  },\r\n  mounted () {\r\n    this.getGoodsList(this.sort, this.status, 1, '')\r\n  }\r\n}\r\n</script>\r\n","import { render } from \"./List.vue?vue&type=template&id=67d3b362\"\nimport script from \"./List.vue?vue&type=script&lang=js\"\nexport * from \"./List.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}