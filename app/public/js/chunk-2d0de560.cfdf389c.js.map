{"version":3,"sources":["webpack:///./src/components/System/Password.vue","webpack:///./src/components/System/Password.vue?2bcd"],"names":["class","spinning","ref","model","formData","rules","label","name","value","oldPassword","placeholder","changePassword","newPassword","comfirmPassword","type","style","data","required","message","trigger","min","max","methods","userinfo","$storage","getItem","$refs","form","validate","$message","error","resData","$encrypt","aesEncrypt","JSON","stringify","username","passwordEncrypt","$axios","method","$api","CHANGE_PASSWORD","url","console","log","msg","render"],"mappings":"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","file":"js/chunk-2d0de560.cfdf389c.js","sourcesContent":["<template>\r\n  <a-spin :spinning=\"spinning\">\r\n    <div class=\"content-box\">\r\n      <a-form ref=\"form\" :model=\"formData\" :rules=\"rules\">\r\n        <a-form-item label=\"旧密码\" name=\"oldPassword\">\r\n          <a-input-password v-model:value=\"formData.oldPassword\" placeholder=\"请输入旧密码\" @keyup.enter=\"changePassword\"></a-input-password>\r\n        </a-form-item>\r\n        <a-form-item label=\"新密码\" name=\"newPassword\">\r\n          <a-input-password v-model:value=\"formData.newPassword\" placeholder=\"请输入新密码\" @keyup.enter=\"changePassword\"></a-input-password>\r\n        </a-form-item>\r\n        <a-form-item label=\"确认密码\" name=\"comfirmPassword\">\r\n          <a-input-password v-model:value=\"formData.comfirmPassword\" placeholder=\"请再次输入新密码\" @keyup.enter=\"changePassword\"></a-input-password>\r\n        </a-form-item>\r\n        <a-form-item>\r\n          <a-button type=\"primary\" style=\"margin-right: 14px\" @click=\"changePassword\">保存</a-button>\r\n        </a-form-item>\r\n      </a-form>\r\n    </div>\r\n  </a-spin>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'Password',\r\n  data () {\r\n    return {\r\n      spinning: false,\r\n      formData: {\r\n        oldPassword: '',\r\n        newPassword: '',\r\n        comfirmPassword: ''\r\n      },\r\n      rules: {\r\n        oldPassword: [\r\n          {\r\n            required: true, message: '请输入旧密码', trigger: 'blur'\r\n          },\r\n          {\r\n            min: 6, max: 16, message: '密码长度应在 6~16 之间', trigger: 'blur'\r\n          }\r\n        ],\r\n        newPassword: [\r\n          {\r\n            required: true, message: '请输入新密码', trigger: 'blur'\r\n          },\r\n          {\r\n            min: 6, max: 16, message: '密码长度应在 6~16 之间', trigger: 'blur'\r\n          }\r\n        ],\r\n        comfirmPassword: [\r\n          {\r\n            required: true, message: '请再次输入新密码', trigger: 'blur'\r\n          },\r\n          {\r\n            min: 6, max: 16, message: '密码长度应在 6~16 之间', trigger: 'blur'\r\n          }\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    async changePassword () {\r\n      const userinfo = this.$storage.getItem('userinfo', 'user')\r\n      if (userinfo) {\r\n        try {\r\n          await this.$refs.form.validate()\r\n          if (this.formData.newPassword !== this.formData.comfirmPassword) {\r\n            return this.$message.error('新密码和确认密码不一致')\r\n          }\r\n          if (this.formData.newPassword === this.formData.oldPassword) {\r\n            return this.$message.error('旧密码和新密码不能一致')\r\n          }\r\n          this.spinning = true\r\n          try {\r\n            const resData = this.$encrypt.aesEncrypt(JSON.stringify({\r\n              username: userinfo.username,\r\n              oldPassword: this.$encrypt.passwordEncrypt(this.formData.oldPassword),\r\n              newPassword: this.$encrypt.passwordEncrypt(this.formData.newPassword),\r\n              comfirmPassword: this.$encrypt.passwordEncrypt(this.formData.comfirmPassword)\r\n            }))\r\n            await this.$axios({\r\n              method: this.$api.CHANGE_PASSWORD.method,\r\n              url: this.$api.CHANGE_PASSWORD.url,\r\n              data: {\r\n                data: resData\r\n              }\r\n            })\r\n            this.spinning = false\r\n          } catch (err) {\r\n            console.log('发送ajax请求失败', err)\r\n            this.spinning = false\r\n            if (err.msg && err.msg === '旧密码错误') {\r\n              this.formData.oldPassword = ''\r\n            } else if (err.msg && err.msg === '新密码和确认密码不一致') {\r\n              this.formData.newPassword = ''\r\n              this.formData.comfirmPassword = ''\r\n            }\r\n          }\r\n        } catch (err) {\r\n          console.log('表单验证失败', err)\r\n        }\r\n      } else {\r\n        this.$message.error('系统错误')\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import { render } from \"./Password.vue?vue&type=template&id=5aa2ff88\"\nimport script from \"./Password.vue?vue&type=script&lang=js\"\nexport * from \"./Password.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}