(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0cb770"],{"4a7d":function(e,t,r){"use strict";r.r(t);r("b0c0");var n=r("7a23"),a={class:"content-box"},o={class:"clearfix"},i={key:0},c=Object(n["createVNode"])("div",{class:"ant-upload-text"},"Upload",-1),u=Object(n["createTextVNode"])("保存"),l=Object(n["createTextVNode"])("取消");function s(e,t,r,s,p,d){var b=Object(n["resolveComponent"])("a-input"),m=Object(n["resolveComponent"])("a-form-item"),f=Object(n["resolveComponent"])("plus-outlined"),g=Object(n["resolveComponent"])("a-upload"),v=Object(n["resolveComponent"])("a-input-number"),O=Object(n["resolveComponent"])("a-button"),w=Object(n["resolveComponent"])("a-form"),j=Object(n["resolveComponent"])("a-spin"),h=Object(n["resolveComponent"])("a-modal");return Object(n["openBlock"])(),Object(n["createBlock"])(n["Fragment"],null,[Object(n["createVNode"])(j,{spinning:p.spinning},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])("div",a,[Object(n["createVNode"])(w,{"label-col":{span:24},"wrapper-col":{span:24},ref:"form",rules:p.rules,model:p.category},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(m,{label:"分类名称",name:"name"},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(b,{value:p.category.name,"onUpdate:value":t[1]||(t[1]=function(e){return p.category.name=e}),placeholder:"请输入分类名称"},null,8,["value"])]})),_:1}),Object(n["createVNode"])(m,{label:"分类关键字",name:"keywords"},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(b,{value:p.category.keywords,"onUpdate:value":t[2]||(t[2]=function(e){return p.category.keywords=e}),placeholder:"请输入分类关键字"},null,8,["value"])]})),_:1}),Object(n["createVNode"])(m,{label:"分类图片",name:"list_pic_url",extra:"图标尺寸: 宽度250 高度250，只能上传jpg/png文件"},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])("div",o,[Object(n["createVNode"])(g,{"list-type":"picture-card","file-list":p.list_pic_url,"onUpdate:file-list":t[3]||(t[3]=function(e){return p.list_pic_url=e}),"before-upload":d.beforeUpload,customRequest:d.uploadImage,remove:d.remove,onPreview:d.handlePreview},{default:Object(n["withCtx"])((function(){return[p.list_pic_url.length<1?(Object(n["openBlock"])(),Object(n["createBlock"])("div",i,[Object(n["createVNode"])(f),c])):Object(n["createCommentVNode"])("",!0)]})),_:1},8,["file-list","before-upload","customRequest","remove","onPreview"])])]})),_:1}),Object(n["createVNode"])(m,{label:"排序",name:"sort_order"},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(v,{value:p.category.sort_order,"onUpdate:value":t[4]||(t[4]=function(e){return p.category.sort_order=e}),min:1,max:100},null,8,["value"])]})),_:1}),Object(n["createVNode"])(m,null,{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(O,{type:"primary",size:"large",onClick:d.submit},{default:Object(n["withCtx"])((function(){return[u]})),_:1},8,["onClick"]),Object(n["createVNode"])(O,{style:{"margin-left":"10px"},size:"large",onClick:t[5]||(t[5]=function(t){return e.$router.go(-1)})},{default:Object(n["withCtx"])((function(){return[l]})),_:1})]})),_:1})]})),_:1},8,["rules","model"])])]})),_:1},8,["spinning"]),Object(n["createVNode"])(h,{visible:p.previewVisible,footer:null,onCancel:t[6]||(t[6]=function(e){return p.previewVisible=!1})},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])("img",{alt:"预览图片",style:{width:"100%"},src:e.previewImage},null,8,["src"])]})),_:1},8,["visible"])],64)}var p=r("1da1"),d=(r("d3b7"),r("96cf"),r("47ce")),b={name:"AddCategory",components:{PlusOutlined:d["a"]},data:function(){return{spinning:!1,rules:{name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]},category:{},list_pic_url:[],previewVisible:!1}},methods:{getCategory:function(e){var t=this;return Object(p["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.spinning=!0,r.prev=1,r.next=4,t.$axios({method:t.$api.GET_CATEGORY_INFO.method,url:t.$api.GET_CATEGORY_INFO.url,params:{id:e}});case 4:n=r.sent,t.category=n.data.info,t.list_pic_url=[{uid:"1",name:"list_pic",status:"done",url:n.data.info.icon_url}],t.spinning=!1,r.next=14;break;case 10:r.prev=10,r.t0=r["catch"](1),console.log(r.t0),t.spinning=!1;case 14:case"end":return r.stop()}}),r,null,[[1,10]])})))()},getBase64:function(e){return Object(p["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return r(e)}})));case 1:case"end":return t.stop()}}),t)})))()},handlePreview:function(e){var t=this;return Object(p["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.url||e.preview){r.next=4;break}return r.next=3,t.getBase64(e.originFileObj);case 3:e.preview=r.sent;case 4:t.previewImage=e.url||e.preview,t.previewVisible=!0;case 6:case"end":return r.stop()}}),r)})))()},beforeUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||this.$message.error("只允许上传JPG和PNG格式的图片");var r=e.size/1024/1024<2;return r||this.$message.error("只允许上传小于2M的图片"),t&&r},uploadImage:function(e){var t=this;return Object(p["a"])(regeneratorRuntime.mark((function r(){var n,a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.file,a=new FormData,a.append("file",n),t.spinning=!0,r.prev=4,r.next=7,t.$axios({method:t.$api.POST_UPLOAD_IMAGE.method,url:t.$api.POST_UPLOAD_IMAGE.url,data:a,onUploadProgress:function(t){var r=t.loaded/t.total*100|0;e.onProgress({percent:r})}});case 7:o=r.sent,e.onSuccess(),t.spinning=!1,t.category.icon_url=o.data.url,r.next=19;break;case 13:return r.prev=13,r.t0=r["catch"](4),console.log(r.t0),e.onError(),t.spinning=!1,r.abrupt("return","");case 19:case"end":return r.stop()}}),r,null,[[4,13]])})))()},remove:function(){return this.category.icon_url="",!0},submit:function(){var e=this;return Object(p["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.spinning=!0,t.prev=1,t.next=4,e.$refs.form.validate();case 4:if(""===e.id?e.category.type="add":e.category.type="update",""!==e.category.icon_url&&null!==e.category.icon_url){t.next=7;break}return t.abrupt("return",e.$message.error("分类图片不能为空"));case 7:return t.next=9,e.$axios({method:e.$api.POST_SAVE_CATEGORY.method,url:e.$api.POST_SAVE_CATEGORY.url,data:{category:e.category}});case 9:e.spinning=!1,setTimeout((function(){e.$router.go(-1)}),1e3),t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](1),console.log(t.t0),e.spinning=!1;case 17:case"end":return t.stop()}}),t,null,[[1,13]])})))()}},mounted:function(){var e=this.$route.query.id;e?this.getCategory(e):this.category={id:"",icon_url:"",icon_display:!0,is_show:!0,keywords:"",name:"",show_index:!0,sort_order:1}}};b.render=s;t["default"]=b}}]);
//# sourceMappingURL=chunk-2d0cb770.68dd5e42.js.map