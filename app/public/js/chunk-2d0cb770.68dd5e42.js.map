{"version":3,"sources":["webpack:///./src/components/Goods/AddCategory.vue","webpack:///./src/components/Goods/AddCategory.vue?f118"],"names":["class","spinning","label-col","wrapper-col","ref","rules","model","category","label","name","value","placeholder","keywords","extra","list-type","file-list","list_pic_url","before-upload","beforeUpload","customRequest","uploadImage","remove","handlePreview","length","sort_order","min","max","type","size","submit","style","$router","go","visible","previewVisible","footer","alt","src","previewImage","components","PlusOutlined","data","required","message","trigger","methods","getCategory","id","$axios","method","$api","GET_CATEGORY_INFO","url","params","response","info","uid","status","icon_url","console","log","getBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","preview","originFileObj","isJpgOrPng","this","$message","isLt2M","formData","FormData","append","POST_UPLOAD_IMAGE","onUploadProgress","percent","loaded","total","onProgress","onSuccess","onError","$refs","form","validate","POST_SAVE_CATEGORY","setTimeout","mounted","$route","query","icon_display","is_show","show_index","render"],"mappings":"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","file":"js/chunk-2d0cb770.68dd5e42.js","sourcesContent":["<template>\r\n  <a-spin :spinning=\"spinning\">\r\n    <div class=\"content-box\">\r\n      <a-form :label-col=\"{span: 24}\" :wrapper-col=\"{span: 24}\" ref=\"form\" :rules=\"rules\" :model=\"category\">\r\n        <a-form-item label=\"分类名称\" name=\"name\">\r\n          <a-input v-model:value=\"category.name\" placeholder=\"请输入分类名称\" />\r\n        </a-form-item>\r\n        <a-form-item label=\"分类关键字\" name=\"keywords\">\r\n          <a-input v-model:value=\"category.keywords\" placeholder=\"请输入分类关键字\" />\r\n        </a-form-item>\r\n        <a-form-item label=\"分类图片\" name=\"list_pic_url\" extra=\"图标尺寸: 宽度250 高度250，只能上传jpg/png文件\">\r\n          <div class=\"clearfix\">\r\n            <a-upload\r\n              list-type=\"picture-card\"\r\n              v-model:file-list=\"list_pic_url\"\r\n              :before-upload=\"beforeUpload\"\r\n              :customRequest=\"uploadImage\"\r\n              :remove=\"remove\"\r\n              @preview=\"handlePreview\"\r\n            >\r\n              <div v-if=\"list_pic_url.length < 1\">\r\n                <plus-outlined />\r\n                <div class=\"ant-upload-text\">Upload</div>\r\n              </div>\r\n            </a-upload>\r\n          </div>\r\n        </a-form-item>\r\n        <a-form-item label=\"排序\" name=\"sort_order\">\r\n          <a-input-number v-model:value=\"category.sort_order\" :min=\"1\" :max=\"100\"></a-input-number>\r\n        </a-form-item>\r\n        <a-form-item>\r\n          <a-button type=\"primary\" size=\"large\" @click=\"submit\">保存</a-button>\r\n          <a-button style=\"margin-left: 10px\" size=\"large\" @click=\"$router.go(-1)\">取消</a-button>\r\n        </a-form-item>\r\n      </a-form>\r\n    </div>\r\n  </a-spin>\r\n  <a-modal :visible=\"previewVisible\" :footer=\"null\" @cancel=\"previewVisible = false\">\r\n    <img alt=\"预览图片\" style=\"width: 100%\" :src=\"previewImage\" />\r\n  </a-modal>\r\n</template>\r\n\r\n<script>\r\nimport { PlusOutlined } from '@ant-design/icons-vue'\r\n\r\nexport default {\r\n  name: 'AddCategory',\r\n  components: {\r\n    PlusOutlined\r\n  },\r\n  data () {\r\n    return {\r\n      spinning: false,\r\n      rules: {\r\n        name: [\r\n          {\r\n            required: true, message: '请输入分类名称', trigger: 'blur'\r\n          }\r\n        ]\r\n      },\r\n      category: {},\r\n      list_pic_url: [],\r\n      previewVisible: false\r\n    }\r\n  },\r\n  methods: {\r\n    async getCategory (id) {\r\n      this.spinning = true\r\n      try {\r\n        const response = await this.$axios({\r\n          method: this.$api.GET_CATEGORY_INFO.method,\r\n          url: this.$api.GET_CATEGORY_INFO.url,\r\n          params: {\r\n            id\r\n          }\r\n        })\r\n        this.category = response.data.info\r\n        this.list_pic_url = [\r\n          {\r\n            uid: '1',\r\n            name: 'list_pic',\r\n            status: 'done',\r\n            url: response.data.info.icon_url\r\n          }\r\n        ]\r\n        this.spinning = false\r\n      } catch (err) {\r\n        console.log(err)\r\n        this.spinning = false\r\n      }\r\n    },\r\n    // 将图片转换成base64供预览\r\n    async getBase64 (file) {\r\n      return new Promise((resolve, reject) => {\r\n        const reader = new FileReader()\r\n        reader.readAsDataURL(file)\r\n        reader.onload = () => resolve(reader.result)\r\n        reader.onerror = error => reject(error)\r\n      })\r\n    },\r\n    // 点击图片预览的方法\r\n    async handlePreview (file) {\r\n      if (!file.url && !file.preview) {\r\n        file.preview = await this.getBase64(file.originFileObj)\r\n      }\r\n      this.previewImage = file.url || file.preview\r\n      this.previewVisible = true\r\n    },\r\n    // 图片上传前的回调\r\n    beforeUpload (file) {\r\n      const isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png'\r\n      if (!isJpgOrPng) {\r\n        this.$message.error('只允许上传JPG和PNG格式的图片')\r\n      }\r\n      const isLt2M = file.size / 1024 / 1024 < 2\r\n      if (!isLt2M) {\r\n        this.$message.error('只允许上传小于2M的图片')\r\n      }\r\n      return isJpgOrPng && isLt2M\r\n    },\r\n    // 上传图片的方法\r\n    async uploadImage (data) {\r\n      const file = data.file\r\n      const formData = new FormData()\r\n      formData.append('file', file)\r\n      this.spinning = true\r\n      try {\r\n        const response = await this.$axios({\r\n          method: this.$api.POST_UPLOAD_IMAGE.method,\r\n          url: this.$api.POST_UPLOAD_IMAGE.url,\r\n          data: formData,\r\n          onUploadProgress: result => {\r\n            const percent = ((result.loaded / result.total) * 100) | 0\r\n            data.onProgress({ percent })\r\n          }\r\n        })\r\n        data.onSuccess()\r\n        this.spinning = false\r\n        this.category.icon_url = response.data.url\r\n      } catch (err) {\r\n        console.log(err)\r\n        data.onError()\r\n        this.spinning = false\r\n        return ''\r\n      }\r\n    },\r\n    remove () {\r\n      this.category.icon_url = ''\r\n      return true\r\n    },\r\n    async submit () {\r\n      this.spinning = true\r\n      try {\r\n        await this.$refs.form.validate()\r\n        if (this.id === '') {\r\n          this.category.type = 'add'\r\n        } else {\r\n          this.category.type = 'update'\r\n        }\r\n        if (this.category.icon_url === '' || this.category.icon_url === null) {\r\n          return this.$message.error('分类图片不能为空')\r\n        }\r\n        await this.$axios({\r\n          method: this.$api.POST_SAVE_CATEGORY.method,\r\n          url: this.$api.POST_SAVE_CATEGORY.url,\r\n          data: {\r\n            category: this.category\r\n          }\r\n        })\r\n        this.spinning = false\r\n        setTimeout(() => {\r\n          this.$router.go(-1)\r\n        }, 1000)\r\n      } catch (err) {\r\n        console.log(err)\r\n        this.spinning = false\r\n      }\r\n    }\r\n  },\r\n  mounted () {\r\n    const { id } = this.$route.query\r\n    if (id) {\r\n      this.getCategory(id)\r\n    } else {\r\n      this.category = {\r\n        id: '',\r\n        icon_url: '',\r\n        icon_display: true,\r\n        is_show: true,\r\n        keywords: '',\r\n        name: '',\r\n        show_index: true,\r\n        sort_order: 1\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import { render } from \"./AddCategory.vue?vue&type=template&id=62dd1807\"\nimport script from \"./AddCategory.vue?vue&type=script&lang=js\"\nexport * from \"./AddCategory.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}