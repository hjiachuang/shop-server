{"version":3,"sources":["webpack:///./node_modules/ant-design-vue/es/vc-calendar/src/locale/zh_CN.js","webpack:///./node_modules/ant-design-vue/es/time-picker/locale/zh_CN.js","webpack:///./node_modules/ant-design-vue/es/date-picker/locale/zh_CN.js","webpack:///./src/components/Shop/EditAdvertisement.vue","webpack:///./src/components/Shop/EditAdvertisement.vue?a6eb","webpack:///./node_modules/core-js/internals/create-html.js","webpack:///./node_modules/core-js/modules/es.string.link.js","webpack:///./node_modules/core-js/internals/string-html-forced.js"],"names":["today","now","backToToday","ok","timeSelect","dateSelect","weekSelect","clear","month","year","previousMonth","nextMonth","monthSelect","yearSelect","decadeSelect","yearFormat","dayFormat","dateFormat","dateTimeFormat","previousYear","nextYear","previousDecade","nextDecade","previousCentury","nextCentury","locale","placeholder","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","lang","rangePlaceholder","timePickerLocale","class","spinning","label-col","wrapper-col","ref","model","advertisement","label","name","list-type","file-list","list_pic_url","before-upload","beforeUpload","customRequest","uploadImage","remove","handlePreview","value","link_type","goods_id","type","modalVisible","getGoodsSimpleList","link","end_time","valueFormat","show-time","sort_order","min","max","checked","enabled","style","submitAdvertisement","$router","go","visible","previewVisible","footer","alt","src","previewImage","closable","centered","destroyOnClose","width","bodyStyle","data-source","modalTableData","pagination","tablePagination","scroll","rowKey","row","id","title","data-index","default","image","height","record","select","disabled","data","defaultPageSize","hideOnSinglePage","showQuickJumper","showTotal","total","onChange","page","methods","getDetail","$axios","method","$api","GET_ADVERTISEMENT_DETAIL","url","params","response","uid","status","image_url","console","log","GET_GOODS_SIMPLE_LIST","list","getBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","preview","originFileObj","isJpgOrPng","$message","isLt2M","size","formData","FormData","append","POST_UPLOAD_IMAGE","onUploadProgress","percent","loaded","onProgress","onSuccess","onError","SAVE_ADVERTISEMENT","setTimeout","mounted","$route","query","render","requireObjectCoercible","quot","module","exports","string","tag","attribute","S","String","p1","replace","$","createHTML","forcedStringHTMLMethod","proto","forced","fails","METHOD_NAME","test","toLowerCase","split"],"mappings":"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","file":"js/chunk-f924bfe6.ed12ffd4.js","sourcesContent":["export default {\n  today: '今天',\n  now: '此刻',\n  backToToday: '返回今天',\n  ok: '确定',\n  timeSelect: '选择时间',\n  dateSelect: '选择日期',\n  weekSelect: '选择周',\n  clear: '清除',\n  month: '月',\n  year: '年',\n  previousMonth: '上个月 (翻页上键)',\n  nextMonth: '下个月 (翻页下键)',\n  monthSelect: '选择月份',\n  yearSelect: '选择年份',\n  decadeSelect: '选择年代',\n  yearFormat: 'YYYY年',\n  dayFormat: 'D日',\n  dateFormat: 'YYYY年M月D日',\n  dateTimeFormat: 'YYYY年M月D日 HH时mm分ss秒',\n  previousYear: '上一年 (Control键加左方向键)',\n  nextYear: '下一年 (Control键加右方向键)',\n  previousDecade: '上一年代',\n  nextDecade: '下一年代',\n  previousCentury: '上一世纪',\n  nextCentury: '下一世纪'\n};","var locale = {\n  placeholder: '请选择时间'\n};\nexport default locale;","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport CalendarLocale from '../../vc-calendar/src/locale/zh_CN';\nimport TimePickerLocale from '../../time-picker/locale/zh_CN';\nvar locale = {\n  lang: _extends({\n    placeholder: '请选择日期',\n    rangePlaceholder: ['开始日期', '结束日期']\n  }, CalendarLocale),\n  timePickerLocale: _extends({}, TimePickerLocale)\n}; // should add whitespace between char in Button\n\nlocale.lang.ok = '确 定'; // All settings at:\n// https://github.com/vueComponent/ant-design-vue/blob/master/components/date-picker/locale/example.json\n\nexport default locale;","<template>\r\n  <a-spin :spinning=\"spinning\">\r\n    <div class=\"content-box\">\r\n      <a-form :label-col=\"{span: 24}\" :wrapper-col=\"{span: 24}\" ref=\"form\" :model=\"advertisement\">\r\n        <a-form-item label=\"商品图片\" name=\"list_pic_url\">\r\n          <div class=\"clearfix\">\r\n            <a-upload\r\n              list-type=\"picture-card\"\r\n              v-model:file-list=\"list_pic_url\"\r\n              :before-upload=\"beforeUpload\"\r\n              :customRequest=\"uploadImage\"\r\n              :remove=\"() => {\r\n                advertisement.image_url = ''\r\n                return true\r\n              }\"\r\n              @preview=\"handlePreview\"\r\n            >\r\n              <div v-if=\"list_pic_url.length < 1\">\r\n                <plus-outlined />\r\n                <div class=\"ant-upload-text\">Upload</div>\r\n              </div>\r\n            </a-upload>\r\n          </div>\r\n          <small>图片尺寸要求： 宽度750，高度300</small>\r\n        </a-form-item>\r\n        <a-form-item label=\"商品类型\" name=\"link_type\">\r\n          <a-radio-group v-model:value=\"advertisement.link_type\">\r\n            <a-radio :value=\"0\">商品ID</a-radio>\r\n            <a-radio :value=\"1\">链接</a-radio>\r\n          </a-radio-group>\r\n        </a-form-item>\r\n        <a-form-item label=\"商品ID\" name=\"goods_id\" v-if=\"advertisement.link_type === 0\">\r\n          <a-input v-model:value=\"advertisement.goods_id\" placeholder=\"请输入商品ID\"></a-input>\r\n          <a-button type=\"primary\" @click=\"() => {modalVisible = true; getGoodsSimpleList()}\">选择关联商品</a-button>\r\n        </a-form-item>\r\n        <a-form-item label=\"广告链接\" name=\"link\" v-if=\"advertisement.link_type === 1\">\r\n          <a-input v-model:value=\"advertisement.link\" placeholder=\"请输入广告链接\"></a-input>\r\n        </a-form-item>\r\n        <a-form-item label=\"结束时间\" name=\"end_time\">\r\n          <a-date-picker v-model:value=\"advertisement.end_time\" valueFormat=\"YYYY-MM-DD HH:mm:ss\" show-time placeholder=\"请选择日期时间\" :locale=\"locale\" />\r\n        </a-form-item>\r\n        <a-form-item label=\"排序\" name=\"sort_order\">\r\n          <a-input-number v-model:value=\"advertisement.sort_order\" :min=\"1\" :max=\"100\"></a-input-number>\r\n        </a-form-item>\r\n        <a-form-item label=\"启用广告\" name=\"enabled\">\r\n          <a-switch v-model:checked=\"advertisement.enabled\"></a-switch>\r\n        </a-form-item>\r\n        <a-form-item>\r\n          <a-button type=\"primary\" style=\"margin-right: 10px\" @click=\"submitAdvertisement\">保存</a-button>\r\n          <a-button @click=\"$router.go(-1)\">取消</a-button>\r\n        </a-form-item>\r\n      </a-form>\r\n    </div>\r\n  </a-spin>\r\n  <a-modal :visible=\"previewVisible\" :footer=\"null\" @cancel=\"previewVisible = false\">\r\n    <img alt=\"预览图片\" style=\"width: 100%\" :src=\"previewImage\" />\r\n  </a-modal>\r\n  <a-modal\r\n        v-model:visible=\"modalVisible\"\r\n        :closable=\"false\"\r\n        centered\r\n        destroyOnClose\r\n        :width=\"700\"\r\n        :footer=\"null\"\r\n        :bodyStyle=\"{ padding: '12px' }\"\r\n        >\r\n        <a-table\r\n          :data-source=\"modalTableData\"\r\n          :pagination=\"tablePagination\"\r\n          :scroll=\"{ y: 640 }\"\r\n          :rowKey=\"row => row.id\"\r\n        >\r\n          <a-table-column key=\"id\" title=\"ID\" data-index=\"id\" />\r\n          <a-table-column key=\"img_url\" title=\"商品图片\" data-index=\"img_url\">\r\n            <template #default=\"{ text: image }\">\r\n              <a-image :src=\"image\" :width=\"80\" :height=\"80\"></a-image>\r\n            </template>\r\n          </a-table-column>\r\n          <a-table-column key=\"name\" title=\"商品名称\" data-index=\"name\" :width=\"240\" />\r\n          <a-table-column title=\"操作\">\r\n            <template #default=\"{record}\">\r\n              <a-button type=\"danger\" @click=\"select(record)\" :disabled=\"record.id === advertisement.goods_id\">选择</a-button>\r\n            </template>\r\n          </a-table-column>\r\n       </a-table>\r\n      </a-modal>\r\n</template>\r\n\r\n<script>\r\nimport locale from 'ant-design-vue/es/date-picker/locale/zh_CN'\r\nexport default {\r\n  name: 'EditAdvertisement',\r\n  data () {\r\n    return {\r\n      spinning: false,\r\n      advertisement: {},\r\n      list_pic_url: [],\r\n      previewVisible: false,\r\n      previewImage: null,\r\n      locale,\r\n      modalVisible: false,\r\n      modalTableData: [],\r\n      tablePagination: {\r\n        defaultPageSize: 20,\r\n        hideOnSinglePage: true,\r\n        showQuickJumper: true,\r\n        showTotal: (total) => `共 ${total} 条`,\r\n        total: 0,\r\n        onChange: (page) => {\r\n          this.getGoodsSimpleList(page)\r\n          this.page = page\r\n        }\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    async getDetail (id) {\r\n      this.spinning = true\r\n      try {\r\n        const response = await this.$axios({\r\n          method: this.$api.GET_ADVERTISEMENT_DETAIL.method,\r\n          url: this.$api.GET_ADVERTISEMENT_DETAIL.url,\r\n          params: {\r\n            id\r\n          }\r\n        })\r\n        this.advertisement = response.data.advertisement\r\n        this.list_pic_url = [\r\n          {\r\n            uid: '1',\r\n            name: 'list_pic',\r\n            status: 'done',\r\n            url: response.data.advertisement.image_url\r\n          }\r\n        ]\r\n        this.spinning = false\r\n      } catch (err) {\r\n        console.log(err)\r\n        this.spinning = false\r\n      }\r\n    },\r\n    async getGoodsSimpleList (page) {\r\n      this.spinning = true\r\n      try {\r\n        const response = await this.$axios({\r\n          method: this.$api.GET_GOODS_SIMPLE_LIST.method,\r\n          url: this.$api.GET_GOODS_SIMPLE_LIST.url,\r\n          params: {\r\n            page\r\n          }\r\n        })\r\n        this.modalTableData = response.data.list\r\n        this.tablePagination.total = response.data.total\r\n        this.spinning = false\r\n      } catch (err) {\r\n        console.log(err)\r\n        this.spinning = false\r\n      }\r\n    },\r\n    async getBase64 (file) {\r\n      return new Promise((resolve, reject) => {\r\n        const reader = new FileReader()\r\n        reader.readAsDataURL(file)\r\n        reader.onload = () => resolve(reader.result)\r\n        reader.onerror = error => reject(error)\r\n      })\r\n    },\r\n    async handlePreview (file) {\r\n      if (!file.url && !file.preview) {\r\n        file.preview = await this.getBase64(file.originFileObj)\r\n      }\r\n      this.previewImage = file.url || file.preview\r\n      this.previewVisible = true\r\n    },\r\n    beforeUpload (file) {\r\n      const isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png'\r\n      if (!isJpgOrPng) {\r\n        this.$message.error('只允许上传JPG和PNG格式的图片')\r\n      }\r\n      const isLt2M = file.size / 1024 / 1024 < 2\r\n      if (!isLt2M) {\r\n        this.$message.error('只允许上传小于2M的图片')\r\n      }\r\n      return isJpgOrPng && isLt2M\r\n    },\r\n    async uploadImage (data) {\r\n      const file = data.file\r\n      const formData = new FormData()\r\n      formData.append('file', file)\r\n      this.spinning = true\r\n      try {\r\n        const response = await this.$axios({\r\n          method: this.$api.POST_UPLOAD_IMAGE.method,\r\n          url: this.$api.POST_UPLOAD_IMAGE.url,\r\n          data: formData,\r\n          onUploadProgress: result => {\r\n            const percent = ((result.loaded / result.total) * 100) | 0\r\n            data.onProgress({ percent })\r\n          }\r\n        })\r\n        data.onSuccess()\r\n        this.spinning = false\r\n        this.advertisement.image_url = response.data.url\r\n      } catch (err) {\r\n        console.log(err)\r\n        data.onError()\r\n        this.spinning = false\r\n        return ''\r\n      }\r\n    },\r\n    select (data) {\r\n      this.advertisement.goods_id = data.id\r\n      this.modalVisible = false\r\n    },\r\n    async submitAdvertisement () {\r\n      this.spinning = true\r\n      try {\r\n        await this.$axios({\r\n          method: this.$api.SAVE_ADVERTISEMENT.method,\r\n          url: this.$api.SAVE_ADVERTISEMENT.url,\r\n          data: {\r\n            advertisement: this.advertisement\r\n          }\r\n        })\r\n        this.spinning = false\r\n        setTimeout(() => {\r\n          this.$router.go(-1)\r\n        }, 1500)\r\n      } catch (err) {\r\n        console.log(err)\r\n        this.spinning = false\r\n      }\r\n    }\r\n  },\r\n  mounted () {\r\n    const id = this.$route.query.id\r\n    if (id) {\r\n      this.getDetail(id)\r\n    } else {\r\n      this.advertisement = {\r\n        id: '',\r\n        image_url: '',\r\n        enabled: true,\r\n        end_time: '',\r\n        goods_id: '',\r\n        sort_order: 1,\r\n        link: '',\r\n        link_type: 0\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import { render } from \"./EditAdvertisement.vue?vue&type=template&id=81de8f92\"\nimport script from \"./EditAdvertisement.vue?vue&type=script&lang=js\"\nexport * from \"./EditAdvertisement.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","var requireObjectCoercible = require('../internals/require-object-coercible');\n\nvar quot = /\"/g;\n\n// B.2.3.2.1 CreateHTML(string, tag, attribute, value)\n// https://tc39.es/ecma262/#sec-createhtml\nmodule.exports = function (string, tag, attribute, value) {\n  var S = String(requireObjectCoercible(string));\n  var p1 = '<' + tag;\n  if (attribute !== '') p1 += ' ' + attribute + '=\"' + String(value).replace(quot, '&quot;') + '\"';\n  return p1 + '>' + S + '</' + tag + '>';\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.link` method\n// https://tc39.es/ecma262/#sec-string.prototype.link\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('link') }, {\n  link: function link(url) {\n    return createHTML(this, 'a', 'href', url);\n  }\n});\n","var fails = require('../internals/fails');\n\n// check the existence of a method, lowercase\n// of a tag and escaping quotes in arguments\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    var test = ''[METHOD_NAME]('\"');\n    return test !== test.toLowerCase() || test.split('\"').length > 3;\n  });\n};\n"],"sourceRoot":""}